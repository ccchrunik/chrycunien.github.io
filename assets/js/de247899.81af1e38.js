(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2316],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return d},kt:function(){return m}});var i=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=i.createContext({}),p=function(e){var n=i.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},d=function(e){var n=p(e.components);return i.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},s=i.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),s=p(t),m=r,k=s["".concat(c,".").concat(m)]||s[m]||u[m]||a;return t?i.createElement(k,l(l({ref:n},d),{},{components:t})):i.createElement(k,l({ref:n},d))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,l=new Array(a);l[0]=s;var o={};for(var c in n)hasOwnProperty.call(n,c)&&(o[c]=n[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<a;p++)l[p]=t[p];return i.createElement.apply(null,l)}return i.createElement.apply(null,t)}s.displayName="MDXCreateElement"},9734:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return o},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return d},default:function(){return s}});var i=t(4034),r=t(9973),a=(t(7294),t(3905)),l=["components"],o={},c="IO flow",p={unversionedId:"Linux/Script/Syntax/IO",id:"Linux/Script/Syntax/IO",isDocsHomePage:!1,title:"IO flow",description:"File descriptor",source:"@site/docs/Linux/Script/Syntax/IO.md",sourceDirName:"Linux/Script/Syntax",slug:"/Linux/Script/Syntax/IO",permalink:"/docs/Linux/Script/Syntax/IO",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Function",permalink:"/docs/Linux/Script/Syntax/Function"},next:{title:"Special",permalink:"/docs/Linux/Script/Syntax/Special"}},d=[{value:"File descriptor",id:"file-descriptor",children:[],level:2},{value:"Redirection and Pipe",id:"redirection-and-pipe",children:[{value:"Operator",id:"operator",children:[],level:3},{value:"Example",id:"example",children:[],level:3}],level:2},{value:"References",id:"references",children:[],level:2}],u={toc:d};function s(e){var n=e.components,t=(0,r.Z)(e,l);return(0,a.kt)("wrapper",(0,i.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"io-flow"},"IO flow"),(0,a.kt)("h2",{id:"file-descriptor"},"File descriptor"),(0,a.kt)("p",null,"Everything in a Unix-like system is a file, including IO. Each file has a file descriptor associated with it."),(0,a.kt)("p",null,"There are 3 special file descriptors"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"STDIN")," ",(0,a.kt)("inlineCode",{parentName:"li"},"0"),": standard input, like you keyboard, other file, ..."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," ",(0,a.kt)("inlineCode",{parentName:"li"},"1"),": like your console, monitor, ..."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," ",(0,a.kt)("inlineCode",{parentName:"li"},"2"),": usually the same as you console, but can be another file, too")),(0,a.kt)("p",null,"Each file descriptors point to some file (a reference), so when you do some redirection, it actually let the descriptor point to another file (not changing the previous reference). (You will create a new reference if you reference a new file!)"),(0,a.kt)("h2",{id:"redirection-and-pipe"},"Redirection and Pipe"),(0,a.kt)("p",null,"We can change the default setting of the ",(0,a.kt)("inlineCode",{parentName:"p"},"STDIN"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"STDOUT"),", or ",(0,a.kt)("inlineCode",{parentName:"p"},"STDERR")," to other files through redirection and pipe."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"redirection: redirect ",(0,a.kt)("inlineCode",{parentName:"li"},"STDIN"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT"),", or ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," to some ",(0,a.kt)("strong",{parentName:"li"},"file")," (like a txt, device, ...)"),(0,a.kt)("li",{parentName:"ul"},"pipe: redirect the ",(0,a.kt)("inlineCode",{parentName:"li"},"STDIN"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT"),", or ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," to the next ",(0,a.kt)("strong",{parentName:"li"},"command")),(0,a.kt)("li",{parentName:"ul"},"Note: the direction to read redirection in a command is from ",(0,a.kt)("strong",{parentName:"li"},"LEFT")," to ",(0,a.kt)("strong",{parentName:"li"},"RIGHT"))),(0,a.kt)("h3",{id:"operator"},"Operator"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"<")," = ",(0,a.kt)("inlineCode",{parentName:"li"},"0<"),": redirect ",(0,a.kt)("inlineCode",{parentName:"li"},"STDIN")," to another file"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},">")," = ",(0,a.kt)("inlineCode",{parentName:"li"},"1>"),": redirect ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," to another file"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"2>"),": redirect ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," to another file"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"&1"),": the ",(0,a.kt)("inlineCode",{parentName:"li"},"1")," file descriptor"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"2>&1")," (old way): redirect ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," to descriptor ",(0,a.kt)("inlineCode",{parentName:"li"},"1")," (",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT"),")"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"&>")," (new way): redirecto both ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," to ",(0,a.kt)("inlineCode",{parentName:"li"},"1")," (",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT"),")"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},">&2"),": redirect ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," to ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"|"),": pipe the ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," to the next command"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"|&"),": pipe both ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," to the next command"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/dev/null"),": null device (just like a black hole)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"2>&1 >/dev/null"),": send only ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," to the next command",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"First, redirect ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," to ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," (actually make the ",(0,a.kt)("inlineCode",{parentName:"li"},"STDERR")," point to the same file description that ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," is currently referring to (see ",(0,a.kt)("inlineCode",{parentName:"li"},"dup2()")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"open()"),"))"),(0,a.kt)("li",{parentName:"ul"},"Second, redirect ",(0,a.kt)("inlineCode",{parentName:"li"},"STDOUT")," to ",(0,a.kt)("inlineCode",{parentName:"li"},"/dev/null"))))),(0,a.kt)("h3",{id:"example"},"Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\n\n# This script demonstrates I/O redirection.\n\n# Redirect STDOUT to a file.\nFILE="/tmp/data"\nhead -n1 /etc/passwd > ${FILE}\n\n# Redirect STDIN to a program.\nread LINE < ${FILE}\necho "LINE contains: ${LINE}"\n\n# Redirect STDOUT to a file, overwriting the file.\nhead -n3 /etc/passwd > ${FILE}\necho\necho "Contents of ${FILE}:"\ncat ${FILE}\n\n# Redirect STDOUT to a file, appending to the file.\necho "${RANDOM} ${RANDOM}" >> ${FILE}\necho "${RANDOM} ${RANDOM}" >> ${FILE}\necho\necho "Contents of ${FILE}:"\ncat ${FILE}\n\n# Redirect STDIN to a program, using FD 0.\nread LINE 0< ${FILE}\necho\necho "LINE contains: ${LINE}"\n\n# Redirect STDOUT to a file using FD 1, overwriting the file.\nhead -n3 /etc/passwd 1> ${FILE}\necho\necho "Contents of ${FILE}:"\ncat ${FILE}\n\n# Redirect STDERR to a file using FD 2.\nERR_FILE="/tmp/data.err"\nhead -n3 /etc/passwd /fakefile 2> ${ERR_FILE}\necho\necho "Contents of ${ERR_FILE}:"\ncat ${ERR_FILE}\n\n# Redirect STDOUT and STDERR to a file.\nhead -n3 /etc/passwd /fakefile &> ${FILE}\necho\necho "Contents of ${FILE}:"\ncat ${FILE}\n\n# Redirect STDOUT and STDERR through a pipe.\necho\nhead -n3 /etc/passwd /fakefile |& cat -n\n\n# Send output to STDERR\necho "This is STDERR!" >&2\n\n# Discard STDOUT\necho\necho "Discarding STDOUT:"\nhead -n3 /etc/passwd /fakefile > /dev/null\n\n# Discard STDERR\necho\necho "Discarding STDERR:"\nhead -n3 /etc/passwd /fakefile 2> /dev/null\n\n# Discard STDOUT and STDERR\necho\necho "Discarding STDOUT and STDERR:"\nhead -n3 /etc/passwd /fakefile &> /dev/null\n\n# Clean up\nrm ${FILE} ${ERR_FILE} &> /dev/null\n')),(0,a.kt)("h2",{id:"references"},"References"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://cloudacademy.com/course/linux-programming-conventions-1519"},"https://cloudacademy.com/course/linux-programming-conventions-1519")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://stackoverflow.com/questions/2342826/how-can-i-pipe-stderr-and-not-stdout"},"https://stackoverflow.com/questions/2342826/how-can-i-pipe-stderr-and-not-stdout"))))}s.isMDXComponent=!0}}]);